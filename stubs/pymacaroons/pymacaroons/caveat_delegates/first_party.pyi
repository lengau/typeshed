from typing import Any

from pymacaroons import Caveat, Macaroon, Verifier

from .base_first_party import BaseFirstPartyCaveatDelegate, BaseFirstPartyCaveatVerifierDelegate

class FirstPartyCaveatDelegate(BaseFirstPartyCaveatDelegate):
    def __init__(self, *args, **kwargs) -> None: ...
    def add_first_party_caveat(self, macaroon: Macaroon, predicate: str | bytes, **kwargs) -> Macaroon: ...

class FirstPartyCaveatVerifierDelegate(BaseFirstPartyCaveatVerifierDelegate):
    def __init__(self, *args, **kwargs) -> None: ...
    def verify_first_party_caveat(self, verifier: Verifier, caveat: Caveat, signature: Any) -> int: ...
    def update_signature(self, signature: bytes | bytearray, caveat: Caveat) -> bytes: ...
